---
title: 用户、用户组与权限
description: 管理对您wiki的访问
published: true
date: 2023-03-16T08:45:000Z
tags: 
editor: markdown
dateCreated: 2023-01-08T10:33:27.804Z
---

虽然一个好的wiki是任何人都可以贡献新内容的地方，但最好将某些部分和特定操作限制在您选定的用户中。

Wiki.js拥有强大的权限系统，可以精细控制用户能看到的内容和能执行的操作。

# 概述

Wiki.js的权限系统基于4个概念设计：

- **用户组**
- **用户**
- **权限**
- **页面规则**
{.grid-list}

一个用户组包含数个用户、一组权限和一组页面规则。

![diag-permissions.jpg](/assets/diagrams/diag-permissions.webp =1000x){.decor-shadow .radius-4}

**用户** 可以属于 **一个或多个** 用户组。

**用户组** 规定用户能看到的内容和能执行的操作。 它通过两个概念来实现这一点： **全局权限** 和 **页面规则**.

**全局权限** 授权用户执行特定操作。例如，全局权限 `read:pages` 允许用户访问页面，而全局权限 `write:assets` 允许用户上传图片和文件。 这些全局权限起总开关的作用，以 **允许或拒绝** 用户在wiki上执行特定操作。

全局权限可以有效控制用户可以执行的操作，但它不能控制权限被应用在**在哪些地方**。 比如，你有可能想要一名用户能查看在 `/cities` 目录下的页面， 但不能查看在 `/secret` 目录下的页面。 这就是 **页面规则** 发挥作用的地方。

**页面规则** 确定全局权限的生效范围。

---

**让我们用下面的例子来解释：**
*我们想让用户组 XYZ 下的用户可以查看路径 `/cities/montreal` 的页面和资源*

需要设定如下的页面规则：

- 允许或拒绝: `允许`
- 权限: `read:pages, read:assets`
- 匹配规则: `路径精确匹配...`
- 匹配值: `/cities/montreal`
{.grid-list}

![ss-pagerule-ex1.png](/assets/examples/ss-pagerule-ex1.webp =1000x)

将上述内容汇总起来，这个用户组需要被这样设置：

- 拥有数名用户
- 启用全局权限 `read:pages` 和 `read:assets`
- 有一条权限为 `允许` `read:pages, read:assets`，使用匹配规则为 `路径精确匹配`... `/cities/montreal` 的页面规则。

---

***规则的应用顺序是？***

规则按精确度应用。更精确的路径的页面规则将覆盖之前的页面规则。

比如, 应用于`/geography/countries`的页面规则将覆盖应用于`/geography`的页面规则。

当两条规则精确度相同（目录的层数相同）时，将按照如下顺序从低优先级到高优先级确定规则：
- 路径开头匹配... *(优先级最低)*{.caption}
- 路径结尾匹配...
- 路径通配符匹配...
- 路径精确匹配... *(优先级最高)*{.caption}

当两条页面规则的精确度和匹配规则均相同时, `拒绝` 规则将默认覆盖 `允许` 规则.

***默认的权限行为是？***

除非您明确对某一权限添加一条 `允许` 规则, 它将始终被默认拒绝. 因此, 不分配权限等同于对所有权限设定 `拒绝` 规则. 因此, `拒绝` 规则只需覆盖之前的（同优先级或更低优先级的） `允许` 规则（上面我们就是这么规定的）。 如果您并没有在相同或更低的优先级上设定`允许`规则，您就不需要在这一优先级上设定`拒绝`规则。

***有了页面规则，为什么你还要设计全局权限？***

某些操作不与任何特定路径相关联。例如，创建用户或管理组的能力。全局权限还可以让管理员快速查看用户组可以做什么，而不必查看一堆页面规则来查看是否应用了权限。在不修改任何页面规则的情况下，全局删除对特定操作的访问也更容易。

***我可以定义具有未在全局权限中启用的权限的页面规则吗？***

不行。全局权限始终优先于页面规则。如果未启用全局权限，页面规则将无效。

***如果我希望用户在所有位置都能使用全局权限，我是否还需要定义页面规则？***

是，但只有内容权限需要您这么做。您需要定义至少一个针对相关内容权限的页面规则，并使用`路径开头匹配`规则并配以空白值。


# 用户组

你可以在 **管理区** 点击侧边栏的 **用户组** 选项来管理用户组。

有两个用户组是系统预先定义好的，不能被删除：

- **Administrators**
- **Guests**
{.grid-list}

你可以在用户组列表中通过锁🔒图标认出它们。您只能向 **Administrators** 用户组增加或删除用户，不能修改其它内容。**Guests**用户组只能被拥有管理员权限的用户编辑。


# 用户

你可以在 **管理区** 点击侧边栏的 **用户** 选项来管理用户组。

## 创建新用户

点击 **创建新用户** 按钮以弹出创建用户的对话框。

选择要创建用户的认证服务 **提供者**。当提供者被设为 本地认证 时，你将在数据库创建一个唯一的用户。当提供者为本地认证以外的服务时，数据库中将储存到外部服务的索引，以在用户登录时识别用户身份。

填写要创建的用户的详细信息：

![ui-user-create.png](/assets/ui/ui-user-create.png =450x){.radius-4 .decor-shadow}

**提示：** 你可以点击骰子图标，让系统自动生成一个强密码。

> **你必须为用户指定至少一个用户组。** 否则，用户将无法访问任何内容。
{.is-warning}

点击 **创建并关闭** 来创建用户。 你也可以点击  **创建** 以在创建这个用户之后继续创建。


## 编辑用户

在 **用户** 列表中，选择您想要编辑的用户。

点击你想要修改的项旁边的 **铅笔:pencil:** 图标。 点击 **更新用户** 按钮（位于页面右上角）来应用修改。

### 停用 / 激活用户

您可以在不删除用户账户的情况下停用账户，以暂停其的访问。要停用账户，点击 **操作** 按钮并选择 **停用**，被停用的用户将不能继续登录。

点击 **激活** 就可重新恢复用户的访问。

### 手动验证用户

如果用户无法验证自己的账户或无法接收验证邮件，你可以通过点击 **操作** 按钮并选择 **设为已验证** 来手动验证用户。

## 删除用户

您可以删除账户，但我们并不推荐这样做。我们更建议您停用用户。

要删除一名用户，请从 **用户** 列表中选中要删除的账户，单击 **操作** 按钮并点击 ** 删除。然后确认你的操作已继续删除流程。

> 请注意，**Guest**账户不能被删除，而且它的某些信息项时被锁定的。
{.is-info}

# 指南

## 私人Wiki

要让你的wiki完全私有并要求访问任何页面都需要认证，你只需要在 **管理区 -> 用户组** 修改 **Guest** 用户组。你可以将默认的 **页面规则** 从 **允许** 改为 **拒绝**，或移除该账户的所有全局权限。上述两种方法都能实现要求。 

## 部门

要分别给您公司的每个部门单独的私有空间，您需要为它们分别创建一个**用户组**。

然后，你需要为刚刚创建的用户组逐个添加**路径开头匹配**的**页面规则**，匹配对应的子目录（如：`/accounting`、`/marketing`等）。

> 注意：您不能使用2个英文字符作为一级子目录。因此，`/hr`或`it`这样的路径会是无效的，因为它们是为特定语言而预留的。
{.is-warning}

从Wiki.js **2.5**，您可以在用户登录后直接将其跳转到其对应的子目录，而不是wiki主页。在早期版本中，`/home`是所有用户登录后被跳转岛的页面。你需要（使用**路径精确匹配**规则）开放`/home`路径的读权限。

![](https://a.icons8.com/kkjevabe/OINR8w/svg.svg){.align-abstopright}
